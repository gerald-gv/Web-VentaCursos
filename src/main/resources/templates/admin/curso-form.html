<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/admin-layout :: layout(~{::content})}">

<div th:fragment="content">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-10 max-w-4xl">

        <div class="mb-10">
            <a href="/admin/cursos"
               class="group inline-flex items-center gap-2 text-slate-400 hover:text-emerald-400 transition-colors mb-6 text-sm font-medium">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4 group-hover:-translate-x-1 transition-transform">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                </svg>
                Volver al listado
            </a>

            <h1 class="text-3xl font-extrabold text-white tracking-tight">
                <span th:text="${esNuevo ? 'Crear Nuevo Curso' : 'Editar Curso'}">Título</span>
            </h1>
            <p class="text-slate-500 mt-1">Completa todos los campos obligatorios para publicar el contenido.</p>
        </div>

        <form th:action="@{/admin/cursos/guardar}"
              method="post"
              th:object="${curso}"
              id="curso-form"
              class="space-y-8">

            <input type="hidden" th:field="*{idCurso}">

            <div class="bg-neutral-900/50 border border-slate-800 rounded-2xl p-8 shadow-sm">
                <div class="flex items-center gap-3 mb-8 border-b border-slate-800/50 pb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-emerald-500">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
                    </svg>
                    <h2 class="text-lg font-bold text-white uppercase tracking-wider">Información Básica</h2>
                </div>

                <div class="grid grid-cols-1 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Título del Curso *</label>
                        <input type="text" th:field="*{titulo}" required
                               class="w-full bg-neutral-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all"
                               placeholder="Ej: Educación financiera desde cero">
                    </div>

                    <div>
                        <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Descripción *</label>
                        <textarea th:field="*{descripcion}" required rows="4"
                                  class="w-full bg-neutral-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all"
                                  placeholder="Describe de qué trata el curso..."></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Precio (USD) *</label>
                            <div class="relative">
                                <span class="absolute left-4 top-3 text-slate-500">$</span>
                                <input type="number" th:field="*{precio}" step="0.01" min="0" required
                                       class="w-full bg-neutral-800 border border-slate-700 rounded-xl pl-8 pr-4 py-3 text-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all">
                            </div>
                            <p class="text-[11px] text-slate-500 mt-2 italic">Usa 0.00 para que el curso sea gratuito.</p>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Docente *</label>
                            <input type="text" th:field="*{instructor}" required
                                   class="w-full bg-neutral-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all">
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Duración *</label>
                            <input type="text" th:field="*{duracion}" required
                                   class="w-full bg-neutral-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all"
                                   placeholder="Ej: 10 horas de video">
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-slate-400 uppercase tracking-widest mb-2">Visibilidad en Catálogo</label>
                            <select th:field="*{activo}"
                                    class="w-full bg-neutral-800 border border-slate-700 rounded-xl px-4 py-3 text-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all appearance-none cursor-pointer">
                                <option th:value="true">Publicado / Activo</option>
                                <option th:value="false">Borrador / Inactivo</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-neutral-900/50 border border-slate-800 rounded-2xl p-6">
                    <div class="flex items-center gap-2 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-blue-400">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                        </svg>
                        <h3 class="text-sm font-bold text-white uppercase">¿Qué aprenderán?</h3>
                    </div>
                    <textarea th:field="*{objetivos}" rows="5"
                              class="w-full bg-neutral-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white focus:border-blue-500 outline-none font-mono text-xs leading-relaxed"
                              placeholder="Un objetivo por línea..."></textarea>
                </div>

                <div class="bg-neutral-900/50 border border-slate-800 rounded-2xl p-6">
                    <div class="flex items-center gap-2 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 text-orange-400">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z" />
                        </svg>
                        <h3 class="text-sm font-bold text-white uppercase">Requisitos previos</h3>
                    </div>
                    <textarea th:field="*{requisitos}" rows="5"
                              class="w-full bg-neutral-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white focus:border-orange-500 outline-none font-mono text-xs leading-relaxed"
                              placeholder="Un requisito por línea..."></textarea>
                </div>
            </div>

            <div class="bg-neutral-900 border border-slate-800 rounded-2xl p-8">
                <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8">
                    <div class="flex items-center gap-3">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-emerald-500">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12" />
                        </svg>
                        <h2 class="text-lg font-bold text-white uppercase tracking-wider">Estructura del Contenido</h2>
                    </div>
                    <button type="button" onclick="agregarModulo()"
                            class="inline-flex items-center gap-2 bg-slate-800 hover:bg-slate-700 text-emerald-400 border border-emerald-500/20 px-4 py-2 rounded-xl text-sm font-bold transition-all">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                            <path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z" />
                        </svg>
                        Añadir Módulo
                    </button>
                </div>

                <div id="modulos-container" class="space-y-4">
                </div>

                <div id="empty-modulos" class="flex flex-col items-center justify-center py-10 border-2 border-dashed border-slate-800 rounded-2xl text-slate-600">
                    <p class="text-sm">Aún no has definido módulos para este curso.</p>
                </div>
            </div>

            <div class="flex flex-col sm:flex-row items-center justify-end gap-4 pt-6 border-t border-slate-800">
                <a href="/admin/cursos"
                   class="w-full sm:w-auto text-center px-8 py-3 text-slate-400 hover:text-white transition-colors font-semibold">
                    Descartar cambios
                </a>
                <button type="submit"
                        class="w-full sm:w-auto bg-emerald-600 hover:bg-emerald-500 text-white px-10 py-4 rounded-xl font-bold transition-all shadow-lg shadow-emerald-900/40 active:scale-95">
                    Guardar Curso
                </button>
            </div>
        </form>
    </div>
    <script th:inline="javascript">
        const modulosExistentes = /*[[${curso.modulos}]]*/ [];
    </script>
    <script th:src="@{/js/admin-curso-form.js}"></script>
</div>
</html>